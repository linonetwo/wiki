{"tiddlers":{"$:/plugins/oflg/fishing-analysis/license":{"title":"$:/plugins/oflg/fishing-analysis/license","text":"MIT License\n\nCopyright (c) 2022 oflg\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.","type":"text/vnd.tiddlywiki"},"$:/plugins/oflg/fishing-analysis/readme":{"title":"$:/plugins/oflg/fishing-analysis/readme","text":"Installation and usage tutorial is available at [[Fishing Manual|https://oflg.github.io/fishing-manual/#Fishing%20Analysis%20sub-plugin]].\n\n可在 [[钓鱼手册|https://oflg.github.io/fishing-manual/#钓鱼分析子插件]] 查看安装使用教程。\n","type":"text/vnd.tiddlywiki"},"$:/plugins/oflg/fishing-analysis/calendar/calendar.js":{"title":"$:/plugins/oflg/fishing-analysis/calendar/calendar.js","text":"/*\\\ntitle: $:/plugins/oflg/fishing-analysis/calendar/calendar.js\ntype: application/javascript\nmodule-type: echarts-component\nCalendar for Fishing.\n\\*/\nexports.shouldUpdate = \"[{$:/temp/fishing}]\";\n\nexports.onUpdate = function (myChart) {\n    var calendarLan = $tw.wiki.filterTiddlers(\"[{$:/language}removeprefix[$:/]addprefix[$:/plugins/oflg/fishing-analysis/]getindex[calendar]]~[[$:/plugins/oflg/fishing-analysis/languages/en-GB]getindex[calendar]]\")[0],\n        learnLan = $tw.wiki.filterTiddlers(\"[{$:/language}removeprefix[$:/]addprefix[$:/plugins/oflg/fishing-analysis/]getindex[learn]]~[[$:/plugins/oflg/fishing-analysis/languages/en-GB]getindex[learn]]\")[0],\n        dueLan = $tw.wiki.filterTiddlers(\"[{$:/language}removeprefix[$:/]addprefix[$:/plugins/oflg/fishing-analysis/]getindex[due]]~[[$:/plugins/oflg/fishing-analysis/languages/en-GB]getindex[due]]\")[0],\n        year1stLan = $tw.wiki.filterTiddlers(\"[{$:/language}removeprefix[$:/]addprefix[$:/plugins/oflg/fishing-analysis/]getindex[year1st]]~[[$:/plugins/oflg/fishing-analysis/languages/en-GB]getindex[year1st]]\")[0],\n        year2stLan = $tw.wiki.filterTiddlers(\"[{$:/language}removeprefix[$:/]addprefix[$:/plugins/oflg/fishing-analysis/]getindex[year2st]]~[[$:/plugins/oflg/fishing-analysis/languages/en-GB]getindex[year2st]]\")[0];\n\n    var year = Number($tw.wiki.filterTiddlers(\"[{$:/temp/fishing!!year}]\")[0]) || new Date().getFullYear();\n\n    var fishArry = $tw.wiki.filterTiddlers(\"[has[due]][has[history]]\");\n\n    var dueDayArry = [],\n        reviewDayArry = [];\n\n    function twTime2twDayArry(twTime, dayArry) {\n        var day = $tw.wiki.filterTiddlers(\"[[\" + twTime + \"]format:date[YYYY-0MM-0DD]]\")[0];\n\n        var dayIndex = dayArry.findIndex(function (df) {\n            return df[0] == day;\n        });\n\n        if (dayIndex == -1) {\n            dayArry.push([\n                day,\n                1\n            ]);\n\n        } else {\n            dayArry.splice(dayIndex, 1, [\n                day,\n                dayArry[dayIndex][1] + 1\n            ]);\n        }\n    }\n\n    function getJson(jsonString) {\n        var result = [];\n        try {\n            result = JSON.parse(jsonString);\n        } catch (error) {\n            console.log(\"JSON error : \" + error);\n        }\n        return [];\n    }\n\n    for (var f = 0; f < fishArry.length; f++) {\n\n        var fishData = $tw.wiki.getTiddler(fishArry[f]);\n\n        var fishDue = fishData.fields[\"due\"],\n            fishReview = fishData.fields[\"review\"],\n            fishHistoryArry = getJson(fishData.fields[\"history\"]);\n\n        if (fishDue) {\n            twTime2twDayArry(fishDue, dueDayArry);\n        }\n\n        if (fishReview) {\n            twTime2twDayArry(fishReview, reviewDayArry);\n        }\n\n        if (fishHistoryArry.length > 0) {\n\n            for (var h = 0; h < fishHistoryArry.length; h++) {\n                var historyReview = fishHistoryArry[h].review;\n\n                twTime2twDayArry(historyReview, reviewDayArry);\n            }\n\n        }\n    }\n\n    var option = {\n        tooltip: {\n            trigger: \"item\",\n            formatter: '{a}<br>{c}'\n        },\n        toolbox: {\n            show: true,\n            orient: \"herizontal\",\n            itemSize: 8,\n            feature: {\n                mark: { show: true },\n                restore: { show: true },\n                saveAsImage: {\n                    show: true,\n                    name: calendarLan\n                }\n            }\n        },\n        legend: {\n            top: \"0\",\n            height: \"10%\",\n            left: \"center\",\n            data: [learnLan, dueLan],\n            textStyle: {\n                color: \"\"\n            }\n        },\n        calendar: [\n            {\n                top: \"15%\",\n                left: \"center\",\n                width: \"80%\",\n                height: \"35%\",\n                range: [year + \"-01-01\", year + \"-06-30\"],\n                splitLine: {\n                    show: true,\n                    lineStyle: {\n                        // color: \"#000\",\n                        width: 1,\n                        type: \"solid\"\n                    }\n                },\n                yearLabel: {\n                    formatter: year1stLan\n                },\n                itemStyle: {\n                    // color: \"#323c48\",\n                    borderWidth: 1,\n                    // borderColor: \"#111\"\n                }\n            },\n            {\n                top: \"60%\",\n                left: \"center\",\n                width: \"80%\",\n                height: \"35%\",\n                range: [year + \"-07-01\", year + \"-12-31\"],\n                splitLine: {\n                    show: true,\n                    lineStyle: {\n                        // color: \"#000\",\n                        width: 1,\n                        type: \"solid\"\n                    }\n                },\n                yearLabel: {\n                    formatter: year2stLan\n                },\n                itemStyle: {\n                    // color: \"#323c48\",\n                    borderWidth: 1,\n                    // borderColor: \"#111\"\n                }\n            }\n        ],\n        series: [\n            {\n                name: learnLan,\n                type: \"scatter\",\n                coordinateSystem: \"calendar\",\n                data: reviewDayArry,\n                symbolSize: function (val) {\n                    return val[1] <= 20 ? val[1] / 2 : 10;\n                },\n                itemStyle: {\n                    opacity: 0.8,\n                    color: \"#547599\"\n                }\n            },\n            {\n                name: learnLan,\n                type: \"scatter\",\n                coordinateSystem: \"calendar\",\n                calendarIndex: 1,\n                data: reviewDayArry,\n                symbolSize: function (val) {\n                    return val[1] <= 20 ? val[1] / 2 : 10;\n                },\n                itemStyle: {\n                    opacity: 0.8,\n                    color: \"#547599\"\n                }\n            },\n            {\n                name: dueLan,\n                type: \"effectScatter\",\n                coordinateSystem: \"calendar\",\n                calendarIndex: 1,\n                data: dueDayArry,\n                symbolSize: function (val) {\n                    return val[1] <= 20 ? val[1] / 2 : 10;\n                },\n                showEffectOn: \"render\",\n                rippleEffect: {\n                    brushType: \"stroke\"\n                },\n                itemStyle: {\n                    opacity: 0.8,\n                    color: \"#5778d8\",\n                    shadowBlur: 10,\n                    shadowColor: \"#333\"\n                },\n                zlevel: 1\n            },\n            {\n                name: dueLan,\n                type: \"effectScatter\",\n                coordinateSystem: \"calendar\",\n                data: dueDayArry,\n                symbolSize: function (val) {\n                    return val[1] <= 20 ? val[1] / 2 : 10;\n                },\n                showEffectOn: \"render\",\n                rippleEffect: {\n                    brushType: \"stroke\"\n                },\n                itemStyle: {\n                    opacity: 0.8,\n                    color: \"#5778d8\",\n                    shadowBlur: 10,\n                    shadowColor: \"#333\"\n                },\n                zlevel: 1\n            }\n        ]\n    };\n\n    option && myChart.setOption(option);\n\n    myChart.on('click', 'series', function (params) {\n\n        if (params.seriesName == dueLan) {\n\n            var day = params.data[0].replace(/\\-/g, '');\n\n            var filter = \"[sameday:due[\" + day + \"]]\";\n\n            $tw.rootWidget.invokeActionString('<$action-setfield $tiddler=\"$:/temp/advancedsearch\" text=\"\"\"' + filter + '\"\"\"/><$action-setfield $tiddler=\"$:/temp/advancedsearch/input\" text=\"\"\"' + filter + '\"\"\"/><$action-setfield $tiddler=\"$:/temp/advancedsearch/refresh\" text=\"yes\"/><$action-setfield $tiddler=\"$:/state/tab--1498284803\" text=\"$:/core/ui/AdvancedSearch/Filter\"/>');\n\n            new $tw.Story().navigateTiddler(\"$:/AdvancedSearch\");\n        }\n\n    });\n};","type":"application/javascript","module-type":"echarts-component"},"$:/plugins/oflg/fishing-analysis/calendar/calendar":{"title":"$:/plugins/oflg/fishing-analysis/calendar/calendar","caption":"<$text text={{{[{$:/language}removeprefix[$:/]addprefix[$:/plugins/oflg/fishing-analysis/]getindex[calendar]]~[[$:/plugins/oflg/fishing-analysis/languages/en-GB]getindex[calendar]]}}}/>","tags":"fishing-analysis","text":"<center style=\"font-size:20px;\"> \n    <$button\n        set=\"$:/temp/fishing!!year\"\n        setTo={{{[{$:/temp/fishing!!year}subtract[1]!match[-1]]~[<now YYYY>subtract[1]]}}}\n        class=\"tc-btn-invisible tc-tiddlylink\"\n \n    >\n        ◄\n    </$button> ''<$text text={{{[{$:/temp/fishing!!year}match[]then<now YYYY>else{$:/temp/fishing!!year}]}}}/>'' <$button\n        set=\"$:/temp/fishing!!year\"\n        setTo={{{[{$:/temp/fishing!!year}add[1]!match[1]]~[<now YYYY>add[1]]}}}\n        class=\"tc-btn-invisible tc-tiddlylink\"\n\n    >\n        ►\n    </$button>\n</center>\n\n<$echarts\n    $tiddler=\"$:/plugins/oflg/fishing-analysis/calendar/calendar.js\"\n    $height=\"380px\"\n    $fillSidebar=\"false\"\n/>"},"$:/plugins/oflg/fishing-analysis/icon":{"title":"$:/plugins/oflg/fishing-analysis/icon","tags":"$:/tags/Image","text":"<svg width=\"22px\" height=\"22px\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns=\"http://www.w3.org/2000/svg\">\n  <g id=\"fishing-analysis\">\n    <path d=\"M0 0L1024 0L1024 1024L0 1024L0 0Z\" id=\"Background\" fill=\"none\" fill-rule=\"evenodd\" stroke=\"none\" />\n    <g clip-path=\"url(#mask_1)\">\n      <path d=\"M260.46 667.8C235.68 625.03 221.5 575.36 221.5 522.38L512 522.38L260.46 667.8L260.46 667.8Z\" id=\"Shape\" fill=\"#3D4265\" fill-rule=\"evenodd\" stroke=\"none\" />\n      <path d=\"M167.24 713.76L512 522.38L614.06 903.29C581.51 911.99 547.29 916.63 512 916.63C363.72 916.62 234.55 834.76 167.24 713.76L167.24 713.76ZM871.46 314.84C906.78 375.89 927 446.77 927 522.38C927 559.53 922.12 595.55 912.96 629.82L512 522.38L871.46 314.84L871.46 314.84ZM97 522.38C97 293.18 282.8 107.38 512 107.38L512 522.38L97 522.38L97 522.38Z\" id=\"Shape\" fill=\"#5778D8\" fill-rule=\"evenodd\" stroke=\"none\" />\n      <path d=\"M512 190.38C634.81 190.38 742.04 257.06 799.47 356.19L512 522.38L512 190.38L512 190.38ZM772.62 592.21C747.81 685.06 674.69 758.18 581.83 783L512 522.38L772.62 592.21L772.62 592.21Z\" id=\"Shape\" fill=\"#3D4265\" fill-rule=\"evenodd\" stroke=\"none\" />\n      <path d=\"M408.25 522.38C408.25 579.679 454.7 626.13 512 626.13C569.299 626.13 615.75 579.68 615.75 522.381C615.75 465.081 569.3 418.63 512 418.63C454.701 418.63 408.25 465.08 408.25 522.38L408.25 522.38Z\" id=\"Shape\" fill=\"#C3D2FB\" fill-rule=\"evenodd\" stroke=\"none\" />\n    </g>\n  </g>\n</svg>"},"$:/plugins/oflg/fishing-analysis/languages/en-GB":{"title":"$:/plugins/oflg/fishing-analysis/languages/en-GB","type":"application/x-tiddler-dictionary","text":"fishing: Fishing\ncalendar: Calendar\nlearn: Learn\ndue: Due\nyear1st: {start} 1st\nyear2st: {start} 2st\ntype: Type\nexcerpt: Excerpt Tiddler\nquestion: Q&A Question Tiddler\ncloze: Cloze Question Tiddler\nselect: Select Question Tiddler\nother: Other Question Tiddler"},"$:/plugins/oflg/fishing-analysis/languages/zh-Hans":{"title":"$:/plugins/oflg/fishing-analysis/languages/zh-Hans","type":"application/x-tiddler-dictionary","text":"fishing: 钓鱼\ncalendar: 日历\nlearn: 学习\ndue: 到期\nyear1st: {start} 上半年\nyear2st: {start} 下半年\ntype: 种类\nexcerpt: 摘抄条目\nquestion: 问答题条目\ncloze: 填空题条目\nselect: 选择题条目\nother: 其他问题条目"},"$:/core/ui/SideBar/FishingAnalysis":{"title":"$:/core/ui/SideBar/FishingAnalysis","caption":"<$text text={{{[{$:/language}removeprefix[$:/]addprefix[$:/plugins/oflg/fishing-analysis/]getindex[fishing]]~[[$:/plugins/oflg/fishing-analysis/languages/en-GB]getindex[fishing]]}}}/>","tags":"$:/tags/SideBar","text":"<div\n    class=\"tc-more-sidebar\"\n>\n<$macrocall\n    $name=\"tabs\"\n    tabsList=\"[all[shadows+tiddlers]tag[fishing-analysis]!has[draft.of]]\"\n    default=\"$:/plugins/oflg/fishing-analysis/calendar/calendar\"\n    state=\"$:/state/tab/fishing-analysis\"\n    class=\"tc-vertical tc-sidebar-tabs-more\"\n    explicitState=\"$:/state/tab/fishing-analysis\"\n/>\n</div>\n"},"$:/plugins/oflg/fishing-analysis/type/type.js":{"title":"$:/plugins/oflg/fishing-analysis/type/type.js","text":"/*\\\ntitle: $:/plugins/oflg/fishing-analysis/type/type.js\ntype: application/javascript\nmodule-type: echarts-component\nTiddler type for Fishing.\n\\*/\nexports.shouldUpdate = \"[{$:/temp/fishing}]\";\n\nexports.onUpdate = function (myChart) {\n    var typeLan = $tw.wiki.filterTiddlers(\"[{$:/language}removeprefix[$:/]addprefix[$:/plugins/oflg/fishing-analysis/]getindex[type]]~[[$:/plugins/oflg/fishing-analysis/languages/en-GB]getindex[type]]\")[0],\n        excerptLan = $tw.wiki.filterTiddlers(\"[{$:/language}removeprefix[$:/]addprefix[$:/plugins/oflg/fishing-analysis/]getindex[excerpt]]~[[$:/plugins/oflg/fishing-analysis/languages/en-GB]getindex[excerpt]]\")[0],\n        questionLan = $tw.wiki.filterTiddlers(\"[{$:/language}removeprefix[$:/]addprefix[$:/plugins/oflg/fishing-analysis/]getindex[question]]~[[$:/plugins/oflg/fishing-analysis/languages/en-GB]getindex[question]]\")[0],\n        clozeLan = $tw.wiki.filterTiddlers(\"[{$:/language}removeprefix[$:/]addprefix[$:/plugins/oflg/fishing-analysis/]getindex[cloze]]~[[$:/plugins/oflg/fishing-analysis/languages/en-GB]getindex[cloze]]\")[0],\n        selectLan = $tw.wiki.filterTiddlers(\"[{$:/language}removeprefix[$:/]addprefix[$:/plugins/oflg/fishing-analysis/]getindex[select]]~[[$:/plugins/oflg/fishing-analysis/languages/en-GB]getindex[select]]\")[0],\n        otherLan = $tw.wiki.filterTiddlers(\"[{$:/language}removeprefix[$:/]addprefix[$:/plugins/oflg/fishing-analysis/]getindex[other]]~[[$:/plugins/oflg/fishing-analysis/languages/en-GB]getindex[other]]\")[0];\n\n    var excerptFilter = \"[search:caption:literal,casesensitive[Excerpt}}]count[]]\",\n        questionFilter = \"[search:caption:literal,casesensitive[Question}}]count[]]\",\n        clozeFilter = \"[search:caption:literal,casesensitive[Cloze}}]count[]]\",\n        selectFilter = \"[search:caption:literal,casesensitive[Select}}]count[]]\",\n        otherFilter = \"[has[due]!search:caption:literal,casesensitive[Excerpt}}]!search:caption:literal,casesensitive[Question}}]!search:caption:literal,casesensitive[Cloze}}]!search:caption:literal,casesensitive[Select}}]count[]]\";\n\n    var typeData = [\n        { value: $tw.wiki.filterTiddlers(excerptFilter)[0], name: excerptLan, filter: excerptFilter.replace(/count\\[\\]/g, \"\") },\n        { value: $tw.wiki.filterTiddlers(questionFilter)[0], name: questionLan, filter: questionFilter.replace(/count\\[\\]/g, \"\") },\n        { value: $tw.wiki.filterTiddlers(clozeFilter)[0], name: clozeLan, filter: clozeFilter.replace(/count\\[\\]/g, \"\") },\n        { value: $tw.wiki.filterTiddlers(selectFilter)[0], name: selectLan, filter: selectFilter.replace(/count\\[\\]/g, \"\") },\n        { value: $tw.wiki.filterTiddlers(otherFilter)[0], name: otherLan, filter: otherFilter.replace(/count\\[\\]/g, \"\") }\n    ];\n\n\n    var option = {\n        tooltip: {\n            trigger: \"item\",\n            formatter: \"{b} : {c} ({d}%)\"\n        },\n        legend: {\n            left: \"center\"\n        },\n        toolbox: {\n            show: true,\n            orient: \"vertical\",\n            itemSize: 8,\n            feature: {\n                mark: { show: true },\n                restore: { show: true },\n                saveAsImage: {\n                    show: true,\n                    name: typeLan\n                }\n            }\n        },\n        series: [\n            {\n                type: \"pie\",\n                width: \"80%\",\n                radius: [\"20\", \"100\"],\n                roseType: \"radius\",\n                avoidLabelOverlap: false,\n                itemStyle: {\n                    borderRadius: 5\n                },\n                label: {\n                    show: false,\n                    position: \"center\"\n                },\n                emphasis: {\n                    label: {\n                        show: false,\n                        fontSize: \"20\",\n                        fontWeight: \"bold\"\n                    }\n                },\n                labelLine: {\n                    show: false\n                },\n                data: typeData\n            }\n        ]\n    };\n\n    option && myChart.setOption(option);\n\n    myChart.on('click', 'series', function (params) {\n\n        console.log(params.data.filter);\n\n        var filter = params.data.filter;\n\n        $tw.rootWidget.invokeActionString('<$action-setfield $tiddler=\"$:/temp/advancedsearch\" text=\"\"\"' + filter + '\"\"\"/><$action-setfield $tiddler=\"$:/temp/advancedsearch/input\" text=\"\"\"' + filter + '\"\"\"/><$action-setfield $tiddler=\"$:/temp/advancedsearch/refresh\" text=\"yes\"/><$action-setfield $tiddler=\"$:/state/tab--1498284803\" text=\"$:/core/ui/AdvancedSearch/Filter\"/>');\n\n        new $tw.Story().navigateTiddler(\"$:/AdvancedSearch\");\n\n    });\n};","type":"application/javascript","module-type":"echarts-component"},"$:/plugins/oflg/fishing-analysis/type/type":{"title":"$:/plugins/oflg/fishing-analysis/type/type","caption":"<$text text={{{[{$:/language}removeprefix[$:/]addprefix[$:/plugins/oflg/fishing-analysis/]getindex[type]]~[[$:/plugins/oflg/fishing-analysis/languages/en-GB]getindex[type]]}}}/>","list-after":"$:/plugins/oflg/fishing-analysis/calendar/calendar","tags":"fishing-analysis","text":"<$echarts\n    $tiddler=\"$:/plugins/oflg/fishing-analysis/type/type.js\"\n    $height=\"400px\"\n    $fillSidebar=\"false\"\n/>"}}}